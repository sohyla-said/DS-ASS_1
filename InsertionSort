

#include <bits/stdc++.h>
#include <chrono>

using namespace std;
// Template for a generic Student object
template <typename T>
class Student {
private:
    string id;
    string name;
    double gpa;

public:
    // Constructor
    Student(string studentId, string studentName, T studentGpa) {
        id = studentId;
        name = studentName;
        gpa = studentGpa;
    }

    bool operator>(const Student<T>& other) const {
        // Sort by name by default
        return name > other.name;
    }

    // Friend function for printing
    friend ostream& operator<<(ostream& os, const Student<T>& s) {
        os << "ID: " << s.id << ", Name: " << s.name << ", GPA: " << s.gpa;
        return os;
    }

    string getID() const {
        return id;
    }
    string getName() const {
        return name;
    }
    const double getGPA()const{
        return gpa;
    }
};


template <class T>
void insertionSort(vector<Student<T>>& students, bool sortByGPA , int& comparisons) {
    for (int i = 1; i < students.size(); i++) {
        Student<T> key = students[i];
        int j = i - 1;
        while (j >= 0 && ((sortByGPA && students[j].getGPA() < key.getGPA()) || (!sortByGPA && students[j] > key))) {
            students[j + 1] = students[j];
            j = j - 1;
            comparisons++;
        }
        students[j + 1] = key;
    }
}

template <typename T>
void print(ostream& os, const vector<T>& students) {
    for (const T& student : students) {
        os << student << endl;
    }
}


int main() {
    // Read student data from file (students.txt)
    ifstream infile("students.txt");
    if (!infile.is_open()) {
        cerr << "Error opening file 'students.txt'" << endl;
        return 1;
    }

    int numStudents;
    infile >> numStudents;
    infile.ignore();

    vector<Student<double>> students;  // Use double for GPA

    for (int i = 0; i < numStudents; ++i) {
        string name, id;
        double gpa;
        getline(infile, name);  // Read entire line for full name
        getline(infile, id);
        infile >> gpa;
        infile.ignore();  // Consume newline character

        students.push_back(Student<double>(id, name, gpa));
    }

    infile.close();

    // Menu for selecting sorting algorithm
    cout << "Select a sorting algorithm:" << endl;
    cout << "1. Insertion Sort" << endl;
    cout << "2. Selection Sort" << endl;
    cout << "3. Bubble Sort" << endl;
    cout << "4. Shell Sort" << endl;
    cout << "5. Merge Sort" << endl;
    cout << "6. Quick Sort" << endl;
    cout << "7. Count Sort" << endl;

    int comparisons = 0;
    int choice;
    cout << "Enter your choice (1-7): ";
    cin >> choice;

    cout << "Sort by:" << endl;
    cout << "1. Name" << endl;
    cout << "2. GPA" << endl;
    cout << "Enter your choice (1-2): ";
    int sortBy;
    cin >> sortBy;
    bool sortByGPA = sortBy == 2;

    switch (choice) {
        case 1: {
            auto start = chrono::high_resolution_clock::now();
            insertionSort(students, sortByGPA, comparisons);
            auto stop = chrono::high_resolution_clock::now();
            auto duration = chrono::duration_cast<chrono::microseconds>(stop - start);

            string fileName = sortByGPA ? "SortedByGPA_InsertionSort.txt" : "SortedByName_InsertionSort.txt";
            ofstream outputFile(fileName);
            if (!outputFile.is_open()) {
                cerr << "Error opening file '" << fileName << "'" << endl;
                return 1;
            }


            outputFile << "Insertion Sort"<<endl;
            outputFile << "Number of comparisons: " << comparisons << endl;
            outputFile << "Running Time (microseconds): " << duration.count() << endl;
            outputFile << (sortByGPA ? "Students Sorted By GPA:\n" : "Students Sorted By Name:\n");
            print(outputFile, students);
            outputFile.close();
            break;
        }
            // Add cases for other sorting algorithms similarly
        default:
            cout << "Invalid choice!" << endl;
            break;
    }

    cout << "Student data sorted and written to file successfully!!" << endl;
    return 0;
}
